import{r as y,C as $,W as D,R as V,j as a,L as Y,a as G}from"./index-BjajsyAQ.js";import X from"./Loading-CY5yTkWN.js";import{u as _}from"./useQuery-DA0d94hU.js";import{f as w,c as A,r as q,p as J,v as K,i as Q,d as U,a as Z,b as ee,n as te,s as se,u as ne,e as re,w as ie,g as L,m as le}from"./proxy-CuF1L5sF.js";function oe(e,t,n){y.useInsertionEffect(()=>e.on(t,n),[e,t,n])}function R(e,t){let n;const s=()=>{const{currentTime:r}=t,l=(r===null?0:r.value)/100;n!==l&&e(l),n=l};return w.update(s,!0),()=>A(s)}const W=new WeakMap;let g;function ce(e,t){if(t){const{inlineSize:n,blockSize:s}=t[0];return{width:n,height:s}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function ae({target:e,contentRect:t,borderBoxSize:n}){var s;(s=W.get(e))===null||s===void 0||s.forEach(r=>{r({target:e,contentSize:t,get size(){return ce(e,n)}})})}function fe(e){e.forEach(ae)}function ue(){typeof ResizeObserver>"u"||(g=new ResizeObserver(fe))}function de(e,t){g||ue();const n=q(e);return n.forEach(s=>{let r=W.get(s);r||(r=new Set,W.set(s,r)),r.add(t),g==null||g.observe(s)}),()=>{n.forEach(s=>{const r=W.get(s);r==null||r.delete(t),r!=null&&r.size||g==null||g.unobserve(s)})}}const S=new Set;let E;function he(){E=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};S.forEach(n=>n(t))},window.addEventListener("resize",E)}function ge(e){return S.add(e),E||he(),()=>{S.delete(e),!S.size&&E&&(E=void 0)}}function me(e,t){return typeof e=="function"?ge(e):de(e,t)}const pe=50,O=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),ve=()=>({time:0,x:O(),y:O()}),xe={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function C(e,t,n,s){const r=n[t],{length:i,position:l}=xe[t],c=r.current,f=n.time;r.current=e[`scroll${l}`],r.scrollLength=e[`scroll${i}`]-e[`client${i}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=J(0,r.scrollLength,r.current);const d=s-f;r.velocity=d>pe?0:K(r.current-c,d)}function we(e,t,n){C(e,"x",t,n),C(e,"y",t,n),t.time=n}function ye(e,t){const n={x:0,y:0};let s=e;for(;s&&s!==t;)if(s instanceof HTMLElement)n.x+=s.offsetLeft,n.y+=s.offsetTop,s=s.offsetParent;else if(s.tagName==="svg"){const r=s.getBoundingClientRect();s=s.parentElement;const i=s.getBoundingClientRect();n.x+=r.left-i.left,n.y+=r.top-i.top}else if(s instanceof SVGGraphicsElement){const{x:r,y:i}=s.getBBox();n.x+=r,n.y+=i;let l=null,c=s.parentNode;for(;!l;)c.tagName==="svg"&&(l=c),c=s.parentNode;s=l}else break;return n}const j={start:0,center:.5,end:1};function N(e,t,n=0){let s=0;if(e in j&&(e=j[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?s=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?s=r/100*document.documentElement.clientWidth:e.endsWith("vh")?s=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(s=t*e),n+s}const Ee=[0,0];function Le(e,t,n,s){let r=Array.isArray(e)?e:Ee,i=0,l=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,j[e]?e:"0"]),i=N(r[0],n,s),l=N(r[1],t),i-l}const We={All:[[0,0],[1,1]]},Se={x:0,y:0};function ze(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function be(e,t,n){const{offset:s=We.All}=n,{target:r=e,axis:i="y"}=n,l=i==="y"?"height":"width",c=r!==e?ye(r,e):Se,f=r===e?{width:e.scrollWidth,height:e.scrollHeight}:ze(r),d={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let h=!t[i].interpolate;const p=s.length;for(let u=0;u<p;u++){const v=Le(s[u],d[l],f[l],c[i]);!h&&v!==t[i].interpolatorOffsets[u]&&(h=!0),t[i].offset[u]=v}h&&(t[i].interpolate=Q(t[i].offset,U(s),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=Z(0,1,t[i].interpolate(t[i].current))}function je(e,t=e,n){if(n.x.targetOffset=0,n.y.targetOffset=0,t!==e){let s=t;for(;s&&s!==e;)n.x.targetOffset+=s.offsetLeft,n.y.targetOffset+=s.offsetTop,s=s.offsetParent}n.x.targetLength=t===e?t.scrollWidth:t.clientWidth,n.y.targetLength=t===e?t.scrollHeight:t.clientHeight,n.x.containerLength=e.clientWidth,n.y.containerLength=e.clientHeight}function Te(e,t,n,s={}){return{measure:()=>je(e,s.target,n),update:r=>{we(e,n,r),(s.offset||s.target)&&be(e,n,s)},notify:()=>t(n)}}const x=new WeakMap,B=new WeakMap,z=new WeakMap,k=e=>e===document.documentElement?window:e;function T(e,{container:t=document.documentElement,...n}={}){let s=z.get(t);s||(s=new Set,z.set(t,s));const r=ve(),i=Te(t,e,r,n);if(s.add(i),!x.has(t)){const c=()=>{for(const u of s)u.measure()},f=()=>{for(const u of s)u.update(ee.timestamp)},d=()=>{for(const u of s)u.notify()},h=()=>{w.read(c,!1,!0),w.read(f,!1,!0),w.update(d,!1,!0)};x.set(t,h);const p=k(t);window.addEventListener("resize",h,{passive:!0}),t!==document.documentElement&&B.set(t,me(t,h)),p.addEventListener("scroll",h,{passive:!0})}const l=x.get(t);return w.read(l,!1,!0),()=>{var c;A(l);const f=z.get(t);if(!f||(f.delete(i),f.size))return;const d=x.get(t);x.delete(t),d&&(k(t).removeEventListener("scroll",d),(c=B.get(t))===null||c===void 0||c(),window.removeEventListener("resize",d))}}function He({source:e,container:t,axis:n="y"}){e&&(t=e);const s={value:0},r=T(i=>{s.value=i[n].progress*100},{container:t,axis:n});return{currentTime:s,cancel:r}}const b=new Map;function I({source:e,container:t=document.documentElement,axis:n="y"}={}){e&&(t=e),b.has(t)||b.set(t,{});const s=b.get(t);return s[n]||(s[n]=se()?new ScrollTimeline({source:t,axis:n}):He({source:t,axis:n})),s[n]}function Oe(e){return e.length===2}function M(e){return e&&(e.target||e.offset)}function Ce(e,t){return Oe(e)||M(t)?T(n=>{e(n[t.axis].progress,n)},t):R(e,I(t))}function Ne(e,t){if(e.flatten(),M(t))return e.pause(),T(n=>{e.time=e.duration*n[t.axis].progress},t);{const n=I(t);return e.attachTimeline?e.attachTimeline(n,s=>(s.pause(),R(r=>{s.time=s.duration*r},n))):te}}function Be(e,{axis:t="y",...n}={}){const s={axis:t,...n};return typeof e=="function"?Ce(e,s):Ne(e,s)}function P(e,t){ie(!!(!t||t.current))}const ke=()=>({scrollX:L(0),scrollY:L(0),scrollXProgress:L(0),scrollYProgress:L(0)});function Pe({container:e,target:t,layoutEffect:n=!0,...s}={}){const r=ne(ke);return(n?re:y.useEffect)(()=>(P("target",t),P("container",e),Be((l,{x:c,y:f})=>{r.scrollX.set(c.current),r.scrollXProgress.set(c.progress),r.scrollY.set(f.current),r.scrollYProgress.set(f.progress)},{...s,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(s.offset)]),r}function Fe(){var v,H;let{addToCart:e}=y.useContext($),{addToWishlist:t,wishlist:n,deleteProduct:s}=y.useContext(D);const[r,i]=y.useState(new Set(((v=n==null?void 0:n.data)==null?void 0:v.map(o=>o.id))||[])),{scrollY:l}=Pe(),[c,f]=V.useState("up");oe(l,"change",o=>{const m=o-l.getPrevious();f(m>0?"down":"up")});function d(){return G.get("https://ecommerce.routemisr.com/api/v1/products?page")}let{data:h,isLoading:p}=_({queryKey:["products"],queryFn:d});const u=async o=>{r.has(o)?(i(m=>new Set([...m].filter(F=>F!==o))),await s(o)):(i(m=>new Set(m.add(o))),await t(o))};return a.jsx(a.Fragment,{children:p?a.jsx(X,{}):a.jsx("div",{className:"my-10 flex flex-wrap justify-center",children:(H=h==null?void 0:h.data)==null?void 0:H.data.map(o=>{const m=r.has(o.id);return a.jsx(le.div,{className:"py-0 px-2 sm:px-2 max-w-64 w-1/2 md:w-1/3 lg:w-1/6",initial:c==="up"?{opacity:0,y:100}:null,whileInView:{opacity:1,y:0},transition:{duration:.5},children:a.jsxs("div",{className:"product hover:shadow-black hover:shadow-xl bg-[#3f3f3f] rounded-lg relative",children:[a.jsx("i",{onClick:()=>u(o.id),className:`fa-xl cursor-pointer top-7 left-4 absolute transition-all duration-200 ${m?"fa-solid fa-heart text-red-600":"fa-regular fa-heart text-gray-400 hover:text-red-600"}`}),a.jsxs(Y,{to:`/productdetails/${o.id}`,className:"block",children:[a.jsx("img",{className:"rounded-t-lg w-full",src:o.imageCover,alt:o.title}),a.jsxs("div",{className:"px-1 py-3 text-center",children:[a.jsx("h2",{className:"mb-2 text-lg font-bold tracking-tight text-main",children:o.slug.split("-",2).join(" ")}),a.jsxs("div",{className:"flex justify-between text-gray-400 px-2 my-1",children:[a.jsx("span",{children:`${o.price} EGP`}),a.jsxs("span",{children:[o.ratingsAverage,a.jsx("span",{children:a.jsx("i",{className:"ps-1 fa fa-star rating-color fa-1x"})})]})]})]})]}),a.jsx("div",{className:"px-5",children:a.jsx("div",{onClick:()=>e(o.id),className:"block cursor-pointer btn bg-main hover:bg-green-400 rounded-lg text-center w-full mx-auto py-2",children:"Add To Cart"})})]})},o.id)})})})}export{Fe as default};
