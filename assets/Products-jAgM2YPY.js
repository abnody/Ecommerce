import{r as p,C as V,W as Y,R as G,j as a,L as X,a as _}from"./index-B4CT-cHI.js";import q from"./Loading-DniYbFyc.js";import{u as J}from"./useQuery-BeaCn16E.js";import{f as w,c as R,r as K,p as Q,v as U,i as Z,d as ee,a as te,b as se,n as ne,s as re,u as ie,e as le,w as oe,g as L,m as ce}from"./proxy-Dj74z-L9.js";function ae(e,t,n){p.useInsertionEffect(()=>e.on(t,n),[e,t,n])}function I(e,t){let n;const s=()=>{const{currentTime:r}=t,l=(r===null?0:r.value)/100;n!==l&&e(l),n=l};return w.update(s,!0),()=>R(s)}const W=new WeakMap;let g;function fe(e,t){if(t){const{inlineSize:n,blockSize:s}=t[0];return{width:n,height:s}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function ue({target:e,contentRect:t,borderBoxSize:n}){var s;(s=W.get(e))===null||s===void 0||s.forEach(r=>{r({target:e,contentSize:t,get size(){return fe(e,n)}})})}function de(e){e.forEach(ue)}function he(){typeof ResizeObserver>"u"||(g=new ResizeObserver(de))}function ge(e,t){g||he();const n=K(e);return n.forEach(s=>{let r=W.get(s);r||(r=new Set,W.set(s,r)),r.add(t),g==null||g.observe(s)}),()=>{n.forEach(s=>{const r=W.get(s);r==null||r.delete(t),r!=null&&r.size||g==null||g.unobserve(s)})}}const S=new Set;let y;function me(){y=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};S.forEach(n=>n(t))},window.addEventListener("resize",y)}function pe(e){return S.add(e),y||me(),()=>{S.delete(e),!S.size&&y&&(y=void 0)}}function ve(e,t){return typeof e=="function"?pe(e):ge(e,t)}const xe=50,O=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),we=()=>({time:0,x:O(),y:O()}),ye={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function N(e,t,n,s){const r=n[t],{length:i,position:l}=ye[t],c=r.current,f=n.time;r.current=e[`scroll${l}`],r.scrollLength=e[`scroll${i}`]-e[`client${i}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=Q(0,r.scrollLength,r.current);const d=s-f;r.velocity=d>xe?0:U(r.current-c,d)}function Ee(e,t,n){N(e,"x",t,n),N(e,"y",t,n),t.time=n}function Le(e,t){const n={x:0,y:0};let s=e;for(;s&&s!==t;)if(s instanceof HTMLElement)n.x+=s.offsetLeft,n.y+=s.offsetTop,s=s.offsetParent;else if(s.tagName==="svg"){const r=s.getBoundingClientRect();s=s.parentElement;const i=s.getBoundingClientRect();n.x+=r.left-i.left,n.y+=r.top-i.top}else if(s instanceof SVGGraphicsElement){const{x:r,y:i}=s.getBBox();n.x+=r,n.y+=i;let l=null,c=s.parentNode;for(;!l;)c.tagName==="svg"&&(l=c),c=s.parentNode;s=l}else break;return n}const j={start:0,center:.5,end:1};function B(e,t,n=0){let s=0;if(e in j&&(e=j[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?s=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?s=r/100*document.documentElement.clientWidth:e.endsWith("vh")?s=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(s=t*e),n+s}const We=[0,0];function Se(e,t,n,s){let r=Array.isArray(e)?e:We,i=0,l=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,j[e]?e:"0"]),i=B(r[0],n,s),l=B(r[1],t),i-l}const ze={All:[[0,0],[1,1]]},be={x:0,y:0};function je(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Te(e,t,n){const{offset:s=ze.All}=n,{target:r=e,axis:i="y"}=n,l=i==="y"?"height":"width",c=r!==e?Le(r,e):be,f=r===e?{width:e.scrollWidth,height:e.scrollHeight}:je(r),d={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let h=!t[i].interpolate;const v=s.length;for(let u=0;u<v;u++){const E=Se(s[u],d[l],f[l],c[i]);!h&&E!==t[i].interpolatorOffsets[u]&&(h=!0),t[i].offset[u]=E}h&&(t[i].interpolate=Z(t[i].offset,ee(s),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=te(0,1,t[i].interpolate(t[i].current))}function He(e,t=e,n){if(n.x.targetOffset=0,n.y.targetOffset=0,t!==e){let s=t;for(;s&&s!==e;)n.x.targetOffset+=s.offsetLeft,n.y.targetOffset+=s.offsetTop,s=s.offsetParent}n.x.targetLength=t===e?t.scrollWidth:t.clientWidth,n.y.targetLength=t===e?t.scrollHeight:t.clientHeight,n.x.containerLength=e.clientWidth,n.y.containerLength=e.clientHeight}function Ce(e,t,n,s={}){return{measure:()=>He(e,s.target,n),update:r=>{Ee(e,n,r),(s.offset||s.target)&&Te(e,n,s)},notify:()=>t(n)}}const x=new WeakMap,k=new WeakMap,z=new WeakMap,P=e=>e===document.documentElement?window:e;function T(e,{container:t=document.documentElement,...n}={}){let s=z.get(t);s||(s=new Set,z.set(t,s));const r=we(),i=Ce(t,e,r,n);if(s.add(i),!x.has(t)){const c=()=>{for(const u of s)u.measure()},f=()=>{for(const u of s)u.update(se.timestamp)},d=()=>{for(const u of s)u.notify()},h=()=>{w.read(c,!1,!0),w.read(f,!1,!0),w.update(d,!1,!0)};x.set(t,h);const v=P(t);window.addEventListener("resize",h,{passive:!0}),t!==document.documentElement&&k.set(t,ve(t,h)),v.addEventListener("scroll",h,{passive:!0})}const l=x.get(t);return w.read(l,!1,!0),()=>{var c;R(l);const f=z.get(t);if(!f||(f.delete(i),f.size))return;const d=x.get(t);x.delete(t),d&&(P(t).removeEventListener("scroll",d),(c=k.get(t))===null||c===void 0||c(),window.removeEventListener("resize",d))}}function Oe({source:e,container:t,axis:n="y"}){e&&(t=e);const s={value:0},r=T(i=>{s.value=i[n].progress*100},{container:t,axis:n});return{currentTime:s,cancel:r}}const b=new Map;function M({source:e,container:t=document.documentElement,axis:n="y"}={}){e&&(t=e),b.has(t)||b.set(t,{});const s=b.get(t);return s[n]||(s[n]=re()?new ScrollTimeline({source:t,axis:n}):Oe({source:t,axis:n})),s[n]}function Ne(e){return e.length===2}function F(e){return e&&(e.target||e.offset)}function Be(e,t){return Ne(e)||F(t)?T(n=>{e(n[t.axis].progress,n)},t):I(e,M(t))}function ke(e,t){if(e.flatten(),F(t))return e.pause(),T(n=>{e.time=e.duration*n[t.axis].progress},t);{const n=M(t);return e.attachTimeline?e.attachTimeline(n,s=>(s.pause(),I(r=>{s.time=s.duration*r},n))):ne}}function Pe(e,{axis:t="y",...n}={}){const s={axis:t,...n};return typeof e=="function"?Be(e,s):ke(e,s)}function A(e,t){oe(!!(!t||t.current))}const Ae=()=>({scrollX:L(0),scrollY:L(0),scrollXProgress:L(0),scrollYProgress:L(0)});function Re({container:e,target:t,layoutEffect:n=!0,...s}={}){const r=ie(Ae);return(n?le:p.useEffect)(()=>(A("target",t),A("container",e),Pe((l,{x:c,y:f})=>{r.scrollX.set(c.current),r.scrollXProgress.set(c.progress),r.scrollY.set(f.current),r.scrollYProgress.set(f.progress)},{...s,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(s.offset)]),r}function De(){var H,C;let{getCart:e,addToCart:t}=p.useContext(V),{getWishlist:n,addToWishlist:s,wishlist:r,deleteProduct:i}=p.useContext(Y);const[l,c]=p.useState(new Set(((H=r==null?void 0:r.data)==null?void 0:H.map(o=>o.id))||[])),{scrollY:f}=Re(),[d,h]=G.useState("up");p.useEffect(()=>{n()},[]),p.useEffect(()=>{e()}),ae(f,"change",o=>{const m=o-f.getPrevious();h(m>0?"down":"up")});function v(){return _.get("https://ecommerce.routemisr.com/api/v1/products?page")}let{data:u,isLoading:E}=J({queryKey:["products"],queryFn:v});const $=async o=>{l.has(o)?(c(m=>new Set([...m].filter(D=>D!==o))),await i(o)):(c(m=>new Set(m.add(o))),await s(o))};return a.jsx(a.Fragment,{children:E?a.jsx(q,{}):a.jsx("div",{className:"my-10 flex flex-wrap justify-center",children:(C=u==null?void 0:u.data)==null?void 0:C.data.map(o=>{const m=l.has(o.id);return a.jsx(ce.div,{className:"py-0 px-2 sm:px-2 max-w-64 w-1/2 md:w-1/3 lg:w-1/6",initial:d==="up"?{opacity:0,y:100}:null,whileInView:{opacity:1,y:0},transition:{duration:.5},children:a.jsxs("div",{className:"product hover:shadow-black hover:shadow-xl bg-[#3f3f3f] rounded-lg relative",children:[a.jsx("i",{onClick:()=>$(o.id),className:`fa-xl cursor-pointer top-7 left-4 absolute transition-all duration-200 ${m?"fa-solid fa-heart text-red-600":"fa-regular fa-heart text-gray-400 hover:text-red-600"}`}),a.jsxs(X,{to:`/productdetails/${o.id}`,className:"block",children:[a.jsx("img",{className:"rounded-t-lg w-full",src:o.imageCover,alt:o.title}),a.jsxs("div",{className:"px-1 py-3 text-center",children:[a.jsx("h2",{className:"mb-2 text-lg font-bold tracking-tight text-main",children:o.slug.split("-",2).join(" ")}),a.jsxs("div",{className:"flex justify-between text-gray-400 px-2 my-1",children:[a.jsx("span",{children:`${o.price} EGP`}),a.jsxs("span",{children:[o.ratingsAverage,a.jsx("span",{children:a.jsx("i",{className:"ps-1 fa fa-star rating-color fa-1x"})})]})]})]})]}),a.jsx("div",{className:"px-5",children:a.jsx("div",{onClick:()=>{t(o.id)},className:"block cursor-pointer btn bg-main hover:bg-green-400 rounded-lg text-center w-full mx-auto py-2",children:"Add To Cart"})})]})},o.id)})})})}export{De as default};
